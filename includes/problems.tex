\section{Problem Suites}
\label{sec:problems}

    We generated several suites of string and regex problems using \fuzzer{}. These problems are available at \problemRepo{}. Below, we describe the \texttt{generated} suite that we generated using \generator{}: \\

    \begin{tabular}{|l|l|}
        \hline
        \textbf{Name}    & \textbf{Problems have ...} \\ \hline
        Concats          & A single, deep tree of concats. \\ \hline
        Concats-Extracts & A single concat tree, and random character extractions. \\ \hline
        Lengths          & A single, large length constraint on a variable. \\ \hline
        Lengths-Concats  & Variables and their concats, each with fixed lengths. \\ \hline
        Overlaps         & A formula in the form A.X = X.B. \\ \hline
        Regex            & A test for regex membership of arbitrary complexity. \\ \hline
        Many-Regexes     & A test for membership in many random regexes. \\ \hline
        Regex-Deep       & A test for membership in a regex with many nested operators. \\ \hline
        Regex-Pair       & A test for membership in one regex, but not another. \\ \hline
        Regex-Lengths    & A test for membership in a regex, and a length constraint. \\ \hline
    \end{tabular}
    \hfill \\

    The \texttt{transformed} suite contains problems generated by using one root problem and transforming it with \transformer{} into many similar problems. They are described below:

    \todo{Federico: fill in descriptions.}

    \begin{tabular}{|l|l|}
        \hline
        \textbf{Name} & \textbf{Description} \\ \hline
        Amazon        & \\ \hline
        Regex         & \\ \hline
    \end{tabular}

    \subsection{Usefulness to \us{}}

        This section describes the bugs we discovered in \us{} (that were subsequently fixed) by testing it with the \fuzzer{} problem suites.

        The first bug we found caused \us{} to perform poorly when the equivalence class of arithmetic terms is very large (e.g. where many strings are equal to the empty string, and thus have length 0). The slowdown was caused by a loop over the equivalence class of these terms to search for an integer constant. The fix was to check the root of the equivalence class for the integer constant, as Z3 makes "interpreted terms" (i.e. constants) the root of equivalence classes whenever possible. This bug was last observed in commit 6308636, and was fixed in commit 3865c45.

        The second bug we found caused \us{} to perform poorly when a variable had a large length constraint. The slowdown was caused by the solver performing a linear search for a satisfying length when producing a model for the variable. This bug was an inconsistency between the implementation and the behaviour described in the \us{} paper \cite{z3str3}. This bug was last observed in commit 66bc68f, and was fixed in commit 7b536e9.

        \todo{Dmitry: maybe show graphs with before and after?}
